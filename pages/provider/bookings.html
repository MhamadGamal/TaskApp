<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>TASKER</title>
    <!-- FONT AWESOME -->
    <link rel="stylesheet" href="../../assets/plugins/fontawesome/css/all.min.css">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="../../assets/css/bootstrap.min.css">
    <!-- Slick -->
    <link rel="stylesheet" href="../../assets/plugins/slick/slick.css">
    <link rel="stylesheet" href="../../assets/plugins/slick/slick-theme.css">
    <!-- DatePicker -->
    <link rel="stylesheet" href="../../assets/css/jquery.datepicker2.css">
    <!-- Custom Style -->
    <link rel="stylesheet" href="../../assets/css/style.css">
</head>

<body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg fixed-top">
            <div class="container">
                <a class="navbar-brand logo bold-font main-color" href="../../index.html">Task<span
                        class="normal-font s-color">app </span></a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class=""> <i class="fas fa-bars    "></i> </span>
                </button>
                <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
                    <ul class="navbar-nav ">
                        <li class="nav-item active ">
                            <a class="nav-link main-btn px-3 py-2 normal" href="addNOffer.html">Add New Offer </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="../provider/dashboard.html">My Dashboard</a>
                        </li>
                        <li class="nav-item notify ">
                            <a class="nav-link " href="bookings.html">My Bookings</a>
    
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <img src="../../assets/img/client/user.png" alt="" srcset="">
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="profile.html"> <i class="fas fa-user"></i>Profile</a>
                                <a class="dropdown-item" href="account.html"> <i class="far fa-address-card"></i> My
                                    Account</a>
                                <a class="dropdown-item" href="credit.html"> <i class="far fa-credit-card"></i> My
                                    Credit</a>
                                <a class="dropdown-item" href="rating.html"><i class="fas fa-star"></i>My Ratings</a>
                                <div class="dropdown-divider"></div>
                                <a id="LogOut" class="dropdown-item" href="#"><i class="fas fa-sign-out-alt"></i>Logout</a>
                            </div>
                        </li>
                    </ul>
                    <!-- <a href="../login/login.html" class="login-btn">
                        <img src="../../assets/img/client/user.png"  alt="" srcset="">
                    
                    </a> -->
                </div>
            </div>
        </nav>
    <!-- /NAVBAR -->
    <!--booking-provider -->
    <section id="task-preview" class="grey-bg page-content">
        <div class="container">
            <div class="page-content-head">
                <h4>My bookings</h4>
            </div>
            <div class="box-content">
                <ul class="nav nav-pills" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="pill" href="#Scheduled">Scheduled</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="pill" href="#active-bookings">Active</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="pill" href="#Closed">Closed</a>
                    </li>
                </ul>
                <div class="tab-content">
                    <div id="Scheduled" class="container tab-pane active">
                        <ul class="pending-bookings-list">
                            <li>
                                <div class="d-flex">
                                    <div class="client-img-block">
                                        <img class="client-img" src="../../assets/img/provider/client-img.jpg" alt="" />
                                    </div>
                                    <div class="booking-details">
                                        <div class="details-head">
                                            <div>
                                                <h5 class="bold-font">Moving help Service</h5> <span></span>
                                            </div>
                                            <span class="client-name"> client name</span>
                                            <p>Lorem Ipsum is simply dummy text of the printing and
                                                typesetting industry. Lorem Ipsum has been the industry's
                                                standard dummy text ever since
                                                the 1500s Lorem Ipsum is simply dummy text of the printing and
                                                typesetting industry </p>
                                        </div>
                                        <div class="offers-numbers">
                                            <div class="messges-offers">
                                                <i class="fas fa-comments"></i>
                                                <span>Messages</span>
                                                <span class="offer-num">4</span>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="d-flex">
                                    <div class="client-img-block">
                                        <img class="client-img" src="../../assets/img/provider/client-img.jpg" alt="" />
                                    </div>
                                    <div class="booking-details">
                                        <div class="details-head">
                                            <div>
                                                <h5 class="bold-font">Moving help Service</h5> <span></span>
                                            </div>
                                            <span class="client-name"> client name</span>
                                            <p>Lorem Ipsum is simply dummy text of the printing and
                                                typesetting industry. Lorem Ipsum has been the industry's
                                                standard dummy text ever since
                                                the 1500s Lorem Ipsum is simply dummy text of the printing and
                                                typesetting industry </p>
                                        </div>
                                        <div class="offers-numbers">
                                            <div class="messges-offers">
                                                <i class="fas fa-comments"></i>
                                                <span>Messages</span>
                                                <span class="offer-num">4</span>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="d-flex">
                                    <div class="client-img-block">
                                        <img class="client-img" src="../../assets/img/provider/client-img.jpg" alt="" />
                                    </div>
                                    <div class="booking-details">
                                        <div class="details-head">
                                            <div>
                                                <h5 class="bold-font">Moving help Service</h5> <span></span>
                                            </div>
                                            <span class="client-name"> client name</span>
                                            <p>Lorem Ipsum is simply dummy text of the printing and
                                                typesetting industry. Lorem Ipsum has been the industry's
                                                standard dummy text ever since
                                                the 1500s Lorem Ipsum is simply dummy text of the printing and
                                                typesetting industry </p>
                                        </div>
                                        <div class="offers-numbers">
                                            <div class="messges-offers">
                                                <i class="fas fa-comments"></i>
                                                <span>Messages</span>
                                                <span class="offer-num">4</span>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div id="active-bookings" class="container tab-pane fade">
                        <ul id="activetasks" class="pending-bookings-list">
                           
                        </ul>
                    </div>
                    <div id="Closed" class="container tab-pane fade">
                        <ul id="closedtasks" class="pending-bookings-list">
                            
                            
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <div class="modal tasks fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="container">
                        <div class="row">
                            <div class="col-sm-2">
                                <img class="img-service" src="../../assets/img/client/service-slider2.png" alt="" />
                            </div>
                            <div class="col-sm-10">
                                <div class="moving-agency">
                                    <div>
                                        <h5 class="bold-font">Gamal Moving Agency</h5>
                                        <div class="rating">
                                            <span class="fa fa-star checked"></span>
                                            <span class="fa fa-star checked"></span>
                                            <span class="fa fa-star checked"></span>
                                            <span class="fa fa-star"></span>
                                            <span class="fa fa-star"></span>
                                            <span>4.5</span>
                                        </div>
                                    </div>
                                    <div class="tasks-numbers">
                                        <i class="fas fa-business-time"></i>
                                        <span>72 Moving Tasks</span>
                                        </i>
                                    </div>
                                    <p>
                                        <h6 class="bold-font">Business Details</h6>
                                        is simply dummy text of the printing
                                        and typesetting industry. Lorem Ipsum has
                                        been the industry's standard dummy text ever
                                        since the 1500s, when an unknown printer took
                                        a galley of type and scrambled it to make a type
                                        specimen book.
                                    </p>
                                    <p>
                                        <h6 class="bold-font">Provider Offer</h6>
                                        Lorem Ipsum is simply dummy text of
                                        the printing and typesetting industry.
                                        Lorem Ipsum has been the industry's standard dummy
                                        text ever since the 1500s, when an unknown printer
                                        took a galley of type and scrambled it to make a type
                                        specimen book. It has survived not only five centuries,
                                        but also the leap into electronic typesetting,
                                        remaining essentially unchanged.
                                    </p>
                                    <div class="actions">
                                        <input type="submit" class="main-btn btn " value="Send Message">
                                        <input type="submit" class="main-btn btn " value="Accept Offer">
                                    </div>
                                    <div class="lastServiceReview">
                                        <h6 class="bold-font">Last Service Review</h6>
                                        <div class="ServiceReview">
                                            <div>
                                                <img class="img-service" src="../../assets/img/client/user.jpg"
                                                    alt="" />
                                            </div>
                                            <div>
                                                <p>"Neque porro quisquam est qui dolorem ipsum quia dolor sit amet,
                                                    consectetur, adipisci velit..."</p>
                                                <span class="client-name"> client name</span>
                                                <div class="date">14 Sat 2018</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--/booking-provider -->
    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="copyright">
                <div class="row">
                    <div class="col-md-6">
                        <a href="contact.html" class="mt-2">Contact us</a>
                        <a href="terms.html" class="mx-2 mt-2   ">Terms & Privecy</a>
                    </div>
                    <div class="col-md-6 text-right">
                        <a class=" logo bold-font main-color mx-2" href="index.html">Task<span
                                class="normal-font s-color">app </span></a>
                        <a href="#"> <i class="fab fa-facebook-f main-color   "></i></a>
                        <a href="#"> <i class="fab fa-twitter  main-color  "></i></a>
                        <a href="#"> <i class="fab fa-instagram  main-color  "></i></a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- /Footer -->
    <!-- <input type="text" class="datepicker" data-select="datepicker"> -->
    <!-- JQUERY -->
    <script src="../../assets/js/jquery.min.js"></script>
    <!-- Bootstarp -->
    <script src="../../assets/js/bootstrap.min.js"></script>
    <script src="../../assets/js/popper.min.js"></script>
    <!-- JQUERY Validation -->
    <script src="../../assets/plugins/jquery-validation/dist/jquery.validate.min.js"></script>
    <!-- Slick -->
    <script src="../../assets/plugins/slick/slick.min.js"></script>
    <!-- Datepicker -->
    <script src="../../assets/js/jquery.datepicker2.min.js"></script>
    <!-- API Script -->
    <script src="../../assets/js/api_script.js"></script>
    <!-- Custom Script -->
    <script src="../../assets/js/script.js"></script>
    <script>
        var currentuserdata = JSON.parse(localStorage.getItem('CurrentUserData'));
        var supplierid = currentuserdata.id;
        function GetInprogressTaslsBySupplier(supplierid) {
            $.ajax({
                url: "http://88.80.184.99/tasker/web/api/inprogres/tasks/suppliers",
                method: 'POST',
                dataType: "json",
                data: {
                    "supplier": supplierid
                },
                success: function (result) {
                    if (result.error.status == true) {
                        var message = result.error.message;
                        alert(message);
                    }
                    else {
                        let taskArr = result.data;
                        for(let item of taskArr)
                        {
                            if (item.images[0]) {
                                img = "http://88.80.184.99/tasker/web/" + item.images[0];
                            } else {
                                img = "https://via.placeholder.com/150"
                            }
                            var div = `
                                <li>
                                <div class ="d-flex">
                                    <div class ="client-img-block">
                                        <img class ="client-img" src=${img} alt="" />
                                    </div>
                                    <div class ="booking-details">
                                        <div class ="details-head">
                                            <div class ="details">
                                                <div>
                                                    <h5 class ="bold-font">${getCategory(Number(item.category)).name_en}</h5> <span></span>
                                                </div>
                                                <p> ${item.description}</p>
                                            </div>
                                            <div>
                                                <a data-id="${item.id}" class ="end-task" href="#"><i class ="fas fa-check-circle"></i> End
                                                    Task</a>
                                            </div>
                                        </div>
                                        <div class ="offers-numbers">
                                            <div class ="messges-offers">
                                                <i class ="fas fa-comments"></i>
                                                <span>Messages</span>
                                                <span class ="offer-num">4</span>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </li>
                                `;
                            $("#activetasks").append(div);
                        }
                    }

                },
                error: function (result) {
                    alert('error');
                }
            });
        }

        function GetCompletedTaslsBySupplier(supplierid) {
            $.ajax({
                url: "http://88.80.184.99/tasker/web/api/completes/tasks/suppliers",
                method: 'POST',
                dataType: "json",
                data: {
                    "supplier": supplierid
                },
                success: function (result) {
                    if (result.error.status == true) {
                        var message = result.error.message;
                        alert(message);
                    }
                    else {
                        let taskArr = result.data;
                        for(let item of taskArr)
                        {
                            if (item.images[0]) {
                                img = "http://88.80.184.99/tasker/web/" + item.images[0];
                            } else {
                                img = "https://via.placeholder.com/150"
                            }
                            var div = `
                                <li>
                                <div class ="d-flex">
                                    <div class ="client-img-block">
                                        <img class ="client-img" src=${img} alt="" />
                                    </div>
                                    <div class ="booking-details">
                                        <div class ="details-head">
                                            <div>
                                                <h5 class ="bold-font">${getCategory(Number(item.category)).name_en}</h5> <span></span>
                                            </div>
                                            <p>${item.description}</p>
                                        </div>
                                        <div class ="offers-numbers">
                                            <div class ="messges-offers">
                                                <i class ="fas fa-comments"></i>
                                                <span>Messages</span>
                                                <span class ="offer-num">4</span>
                                            </div>
                                            <!-- <div class ="offers">
                                            <i class ="fas fa-users"></i>
                                            <span>Providers Offers</span>
                                            <span class ="offer-num">2</span>
                                    </div> -->
                                        </div>

                                    </div>
                                </div>
                            </li>
                                `;
                            $("#closedtasks").append(div);
                        }
                    }

                },
                error: function (result) {
                    alert('error');
                }
            });
        }

        GetInprogressTaslsBySupplier(supplierid);
        GetCompletedTaslsBySupplier(supplierid);

        $("#active-bookings").on("click", ".end-task", function () {

                debugger
                let taskid = $(this).attr("data-id");
                $.ajax({
                    url: "http://88.80.184.99/tasker/web/api/marks/completeds",
                    method: 'POST',
                    dataType: "json",
                    data: {
                        "id": taskid
                    },
                    success: function (result) {
                        if (result.error.status == true) {
                            var message = result.error.message;
                            alert(message);
                        }
                        else {
                            location.reload();
                        }

                    },
                    error: function (result) {
                        alert('error');
                    }
                });
        });
    </script>
</body>

</html>